
<div class="row">
    <div class="col-md-6 banner-sec">
        <h3 style="margin-bottom: 5%;">
            Vehicle {{selected}} : {{pin}}
        </h3>
        <h5>
            Date : {{stdate | date:'dd/MM/yyyy'}}  |  {{endate | date:'dd/MM/yyyy'}}
        </h5>
    </div>
    <div class="col-md-6 banner-sec">
        <div ng-app ng-controller="Ctrl" style="text-align: right; margin-top: 10px;">
            <b style="margin-bottom: 0px;">
                {{date | date:'dd.MM.yyyy'}}
            </b>
        </div>
        <div style="text-align: right;">
            {{date | date:'EEEE'}}
        </div>
    </div>
</div>
<!-- <a routerLink="add" class="btn btn-sm btn-success mb-2">Add User</a> -->





<div class="row" style="margin-bottom: 10px;">
    <div class="col-md-3">
        <div class="input-group-icon input-group-icon-left mr-3">
            <form class="form-inline">
                <i class="fas fa-search" aria-hidden="true"></i>
                <input class="form-control form-control-sm ml-3 w-75" id="key-search" type="text" name="search"
                    [(ngModel)]="searchText" autocomplete="off" placeholder="Search ..."
                    style="background-color: #d9d9d9; ">
            </form>
        </div>
    </div>
    <div class="col-md-3">
        <select class="rounded"
            style="color:#666666;float: left; padding: 4px 40px; background-color: #d9d9d9; text-align: left; border: 0px; outline: 0px;">
            <option selected>
                Select
            </option>
            <option>

            </option>
            <option>

            </option>
        </select>
    </div>

    

    <div class="col-md-6">
        <div  *ngIf="!reportData">
            <span class="spinner-border spinner-border-lg align-center"></span>
        </div>

        <select class="rounded" id="report"
            style="border: 0px; outline: 0px; float: right; padding: 4px 40px; font-weight: bold;"
            (change)="select($event)">
            <option selected value="Report">
                Report
            </option>
            <option value="Consumption">
                Consumption
            </option>
            <option value="Batch">
                Batch
            </option>
            <option value="Engine">
                Engine Hours
            </option>
            
        </select>
    </div>
</div>


<div class="row shadow p-3 rounded" style="background-color: white; margin-left: 0px; margin-right: 0px; margin-bottom: 10px;" >
    <div class = "container" style="margin-top:10px; margin-bottom: 20px;">
        <div class="row">
            <div class = "col-md-3">
                <img src="assets/img/Truck 1.png" style="width: 90%;">
               
            </div>
            <div class = "col-md-4" style="font-size: small;">
                <ul>
                    <li>
                        Machine has run X:XX hrs in last 7 days.
                    </li>
                    <li>
                        Avg run hours is X.XX hrs in last 7 days.
                    </li>
                    <li>
                        Total distance travelled xx kms in last 7 days.
                    </li>
                    <li>
                        Machine last operated XX:XX hrs back at DD-MON-YYYY HH24:MI
                    </li>
                    <li>
                        Last Fuel filled : XX litres on DD-MON-YYYY HH24:MI
                    </li>
                    <li>
                        Second service for this vehicle is due on DD-MON-YYYY HH24:MI /DD-MON-YYYY
                    </li>
                    <li>
                        Last service was done on DD-MON-YYYY HH24:MI  ( First Service, Engine hours XX Hrs )
                    </li>
                </ul>
                (This is currently displaying demo message)
            </div>

            <div class = "col-md-5">
                <div class="row" style="margin-bottom: 20px;">
                    <div class="col-md-3" >
                        <div class="rounded" style="color: white; background-color: red; text-align: center; text-size-adjust:inherit;"> LIVE DATA
                            </div>
                    </div>
                </div>
                    <div class="row">
                        <div class="col-md-2" >
                            <img class="iconl" src="assets/img/RPM.png" >
                        </div>

                        <div class="col-md-3" >
                            {{summeryReport.extras[0].travelSpeed}}
                        </div>
                        <div class="col-md-2" >
                            <img class="iconl" src="assets/img/Engine.png" >
                        </div>

                        <div class="col-md-5" >
                            {{summeryReport.devicePublishTime | date:'dd-MM-yyyy'}}  <br>
                            {{summeryReport.devicePublishTime | date:'h:mm:ss a':'+0000'}}
                        </div>
                        
                    </div>
                    <div class="row" style="margin-top: 20px;">
                        <div class="col-md-2" >
                            <img class="iconl" src="assets/img/Battery.png" >
                        </div>

                        <div class="col-md-3" >
                            {{summeryReport.extras[0].batteryLevel}} V
                        </div>
                        <div class="col-md-2" >
                            <img class="iconl" src="assets/img/Location Pin.png" style="width: 40%;" >
                        </div>

                        <div class="col-md-5" >
                            
                           Lat:{{summeryReport.lat}}
                           <br>
                           Lng : {{summeryReport.lng}}
                        </div>
                        
                        
                    </div>
                    <div class="row" style="margin-top: 20px;">
                        <div class="col-md-2" >
                            <img class="iconl" src="assets/img/Fuel Pump.png" >
                        </div>

                        <div class="col-md-3" >
                            {{summeryReport.extras[0].fuelLevel}} L
                        </div>

                        <div class="col-md-2" >
                            <img class="iconl" src="assets/img/Group 473.png" >
                        </div>

                        <div class="col-md-5" >
                            {{summeryReport.extras[0].coolantTemp}} &#8451;
                        </div>
                    
                        
                    </div>
                        
                    <div style="font-size: small; margin-left: 20%; margin-top: 20px;">
                        *Showing data for last engine on
                    </div>


                
            </div>
            
        </div>
    </div>
    
</div>



<div *ngIf="selected == 'Report'">
    <select class="rounded" id="select2"
    style="border: 0px; outline: 0px; margin-left: 40%; padding: 4px 40px; font-weight: bold; margin-bottom: 10px;"
    (change)="select2($event)">
    <option selected value="on">
        Engine On
    </option>
    <option value="off">
        Engine Off
    </option>    
    </select>
    <br>
    
<div class="tableFixHead" *ngIf="selected2 == 'on'">
    <table class="table table-striped table-bordered table-hover">
        <thead class="thead-dark">
            <tr>
                <th>#</th>
                <th style="width: 10%;">Date & Time</th>
                <th style="width: 9%">Fuel Level</th>
                <th style="width: 9%">Engine</th>
                <th style="width: 9%">RPM</th>
                <th style="width: 9%">Coolant &#8451;</th>
                <th style="width: 9%">Battry Level (volt)</th>
                <th style="width: 9%">Travel Speed (Km/h)</th>
                <th style="width: 9%">Parking Switch</th>
                <th style="width: 9%">Hydraulic Oil Filter Choke</th>
                <th style="width: 9%">Oil Pressure (Bar)</th>

            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let item of EngineOnDatadocs | paginate : {itemsPerPage : 10, currentPage : p} let i = index"
            (click)="setClickedRow(i)" [class.active]="i == selectedRow">
                <td>{{i+1}}</td>
                <td style="width:18%;">{{item.devicePublishTime | date:'dd-MM-yyyy' }} {{item.devicePublishTime | date:'h:mm:ss a':'+0000' }}</td>
                <td>{{item.extras[0].fuelLevel}}</td>
                
                <td>{{item.engineStatus}}</td>
                <td>{{item.extras[0].rpm | number : '1.0-0'}}</td>
                <td>{{item.extras[0].coolantTemp}}</td>
                <td>{{item.extras[0].batteryLevel}}</td>
                <td>{{item.extras[0].travelSpeed}}</td>
                <td>{{item.extras[0].parkingSwitch}}</td>
                <td>{{item.extras[0].hydralicOilFilterChoke}}</td>
                <td>{{item.extras[0].oilpressure}}</td>
            </tr>
            <tr *ngIf="!item">
                <td colspan="11" class="text-center">
                    <span class="spinner-border spinner-border-lg align-center"></span>
                </td>
            </tr>

        </tbody>
    </table>
</div>


<div class="tableFixHead" *ngIf="selected2 == 'off'">
    <table class="table table-striped table-bordered table-hover">
        <thead class="thead-dark">
            <tr>
                <th>#</th>
                <th style="width: 10%;">Date & Time</th>
                <th style="width: 9%">Fuel Level</th>
                <th style="width: 9%">Engine</th>
                <th style="width: 9%">RPM</th>
                <th style="width: 9%">Coolant &#8451;</th>
                <th style="width: 9%">Battry Level (volt) </th>
                <th style="width: 9%">Travel Speed (Km/h)</th>
                <th style="width: 9%">Parking Switch</th>
                <th style="width: 9%">Hydraulic Oil Filter Choke</th>
                <th style="width: 9%">Oil Pressure (Bar)</th>

            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let item of EngineOffDatadocs | paginate : {itemsPerPage : 10, currentPage : p} let i = index"
            (click)="setClickedRow(i)" [class.active]="i == selectedRow">
                <td>{{i+1}}</td>
                <td style="width:18%;">{{item.devicePublishTime | date:'dd-MM-yyyy' }} {{item.devicePublishTime | date:'h:mm:ss a':'+0000' }}</td>
                <td>--</td>
                
                <td>{{item.engineStatus}}</td>
                <td>{{item.extras[0].rpm | number : '1.0-0'}}</td>
                <td>--</td>
                <td>{{item.extras[0].batteryLevel}}</td>
                <td>{{item.extras[0].travelSpeed}}</td>
                <td>--</td>
                <td>--</td>
                <td>--</td>
            </tr>
            <tr *ngIf="!item">
                <td colspan="11" class="text-center">
                    <span class="spinner-border spinner-border-lg align-center"></span>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>




<div class="tableFixHead" *ngIf="selected == 'Consumption'">
    <table class="table table-striped table-bordered table-hover">
        <thead class="thead-dark">
            <tr>
                <th>#</th>
                <th style="width: 10%;">Batch No.</th>
                <th style="width: 9%">AGGT10mm</th>
                <th style="width: 9%">AGGT20mm</th>
                <th style="width: 9%">AGGT30mm</th>
                <th style="width: 9%">CEMT01</th>
                <th style="width: 9%">CEMT02</th>
                <th style="width: 9%">SAND01</th>
                <th style="width: 9%">SAND02</th>
                <th style="width: 9%">Water</th>
                <th style="width: 9%">Additive</th>
                <th style="width: 9%">Total WT</th>

            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let item of consumptionDatadocs | paginate : {itemsPerPage : 10, currentPage : p} let i = index"
            (click)="setClickedRow(i)" [class.active]="i == selectedRow">
                <td>{{i+1}}</td>
                <td>{{item.noOfBatches}}</td>
                <td>{{item.aggt10mm}}</td>
                <td>{{item.aggt20mm}}</td>
                <td>{{item.aggt30mm}}</td>
                <td>{{item.cement01mm}}</td>
                <td>{{item.cement02mm}}</td>
                <td>{{item.sand01mm}}</td>
                <td>{{item.sand02mm}}</td>
                <td>{{item.water}}</td>
                <td>{{item.additive}}</td>
                <td>{{item.totalWT}}</td>
            </tr>
            <tr *ngIf="!item">
                <td colspan="12" class="text-center">
                    <span class="spinner-border spinner-border-lg align-center"></span>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="tableFixHead" *ngIf="selected == 'Batch'">
    <table class="table table-striped table-bordered table-hover">
        <thead class="thead-dark">
            <tr>
		<th>Machine ID</th>
                <th>Batch ID</th>
                <th>Date(DD:MM:YYYY)</th>
                <th >AGGT10mm<br>Kgs</th>
                <th >AGGT20mm<br>Kgs</th>
                <th >AGGT30mm<br>Kgs</th>
                <th >CEMT01<br>Kgs</th>
                <th >CEMT02<br>Kgs</th>
                <th >SAND01<br>Kgs</th>
                <th >SAND02<br>Kgs</th>
                <th >Water<br>Ltrs</th>
                <th >Additive<br>Ltrs</th>
                <th >Total WT<br>Kgs</th>
                <th >CuM</th>
            </tr>
            
        </thead>
        <tbody>
            <tr *ngFor="let item of batchDatadocs | paginate : {itemsPerPage : 10, currentPage : p} let i = index"
            (click)="setClickedRow(i)" [class.active]="i == selectedRow">
		<td>{{item.machineID}}</td>
                <td> {{item.batchNo}}</td>
                <td >{{item.batchDate | date:'dd-MM-yyyy'}}</td>
                <td>{{item.aggt10mm}}</td>
                <td>{{item.aggt20mm}}</td>
                <td>{{item.aggt30mm}}</td>
                <td>{{item.cement01mm}}</td>
                <td>{{item.cement02mm}}</td>
                <td>{{item.sand01mm}}</td>
                <td>{{item.sand02mm}}</td>
                <td>{{item.water}}</td>
                <td>{{item.additive1}}</td>
                <td>{{item.totalWT}}</td>
                <td>{{item.cum}}</td>
            </tr>
            <tr *ngIf="!item">
                <td colspan="11" class="text-center">
                    <span class="spinner-border spinner-border-lg align-center"></span>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<div class="tableFixHead" *ngIf="selected == 'Engine'">

    <table class="table table-striped table-bordered table-hover">
        <thead class="thead-dark">
            <tr>
                <th>#</th>
                <th >Engine OnTime</th>
                <th >Engine OffTime</th>
                <th >Duration</th>

            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let engine of engineDatadocs | paginate : {itemsPerPage : 10, currentPage : p} let i = index"
            (click)="setClickedRow(i)" [class.active]="i == selectedRow">
                <td> {{i+1}} </td>
                <td>{{engine.onTimestamp | slice:8:10}}-{{engine.onTimestamp | slice:5:7}}-{{engine.onTimestamp | slice:0:4}}  {{engine.onTimestamp | date:'h:mm:ss a':'+0000'}} </td>
                <td> {{engine.offTimestamp | slice:8:10}}-{{engine.offTimestamp | slice:5:7}}-{{engine.offTimestamp | slice:0:4}}  {{engine.offTimestamp | date:'h:mm:ss a':'+0000'}} </td>
                <td>{{engine.engineHours}}</td>
                </tr>
                <tr *ngIf="!item">
                    <td colspan="11" class="text-center">
                        <span class="spinner-border spinner-border-lg align-center"></span>
                    </td>
                </tr>
        </tbody>
    </table>
</div>

<div class="row">
    <div class="col-md-2">

    </div>
    <div class="col-md-4">

    </div>
    <div class="col-md-6">
        <div class="input-group-icon input-group-icon-left mr-3">
            <pagination-controls (pageChange)="p = $event"></pagination-controls>
        </div>
    </div>
</div>
