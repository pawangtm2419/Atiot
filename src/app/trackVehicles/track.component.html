<div class="modal fade" id="meter" tabindex="-1" aria-labelledby="example2Label" aria-hidden="true"
>
<div class="modal-dialog modal-lg">
    <div class="modal-content">

<div class="modal-header bg-primary py-2" >
    <h4 class="modal-title d-flex justify-content-center">Live Gauge Meter: </h4>
    <button type="button" #closeButton class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-sm-4" >
        <div class="meter-details">
          <div class="row mb-2">
            <div class="col-sm-5 text-right"><b>Total Engine Hours :</b></div>
            <div class="col-sm-7">
              <p>
                <span class="text-red"></span>
                &nbsp; <b></b> &nbsp;
                <span class="text-red"></span>
              </p>
            </div>
          </div>
          <div class="row mb-2">
            <div class="col-sm-5 text-right"><b>Total Distance(kms) :</b></div>
            <div class="col-sm-7">
              <p><span class="text-red"></span>
                &nbsp; <b></b> &nbsp;
                <span class="text-red"></span></p>
            </div>
          </div>
  
          <h3 class="text-center mb-4 text-red">Live Data
            </h3>
  
          <div class="row">
            <b class="col-sm-7 col-7  text-right">Oil Pressure :</b>
            <div class="col-sm-5 col-5">
              <p class="form-control-static">
                </p>
            </div>
          </div>
          <div class="row">
            <b class="col-sm-7 col-7 text-right">Fuel Level :</b>
            <div class="col-sm-5 col-5">
              <p class="form-control-static"></p>
            </div>
          </div>
          <div class="row">
            <b class="col-sm-7 col-7 text-right text-right">Coolant Temperature :</b>
            <div class="col-sm-5 col-5">
              <p>
               </p>
            </div>
          </div>
          <div class="row">
            <b class="col-sm-7 col-7 text-right">Battery Level :</b>
            <div class="col-sm-5 col-5">
              <p>
               </p>
            </div>
          </div>
          <div class="row">
            <b class="col-sm-7 col-7 text-right">RPM :</b>
            <div class="col-sm-5 col-5">
              <p>
               </p>
            </div>
          </div>
          <div class="row">
            <b class="col-sm-7 col-7 text-right">Hydraulic Oil Filter Choke :</b>
            <div class="col-sm-5 col-5">
              <p>
               
              </p>
            </div>
          </div>
          <div class="row">
            <b class="col-sm-7 col-7 text-right">Parking Brake :</b>
            <div class="col-sm-5 col-5">
              <p>
                </p>
            </div>
          </div>
          <div class="row">
            <b class="text-right col-sm-7 col-7" text-right text-right>Engine Status :</b>
            <div class="col-sm-5">
              <i class="fa fa-plug fa-1x" style="color: green"></i> ON
            </div>
            
          </div>
        </div>
      </div>
      <div class="col-sm-8">
        <div class="main-container mt-0">
          <div class="ajax-img"></div>
          <div class="icon-bg elo"></div>
          <div class="icon-bg holi"></div>
          <div class="icon-bg gare1"></div>
          <div class="icon-bg gare2"></div>
          <div class="icon-bg hbi"></div>
          <div class="icon-bg lri"></div>
          <div class="icon-bg eph"></div>
          <div class="icon-bg hsi"></div>
          <div class="icon-bg neutral"></div>
          <div class="icon-bg wcentring"></div>
          <div class="icon-bg bci" title="Battery">
          </div>
          <div class="icon-bg fri" title="Fuel Status" >
          </div>
          <div class="icon-bg pbfailure"></div>
          <div class="icon-bg pbapplied" title="Parking Brake"
            >
          </div>
          <div class="icon-bg plindicator"></div>
          <div class="icon-bg hof" title="Hydraulic Oil">
          </div>
          <div class="icon-bg ewt"></div>
          <input type="text" id="inputvalwater" title="RPM" 
            readonly="readonly" />
          <input type="text" id="inputval" title="Engine Hours" 
            readonly="readonly" />
          <span class="loc-animate" title="Oil Pressure" >
          </span>
          <div class="container-argo2500" title="Fuel Level">
            <img class="gaugec" 
              src="../../assets/img/meter/argo2500/curve.png" /></div>
          <div class="container-water" title="Coolent Temperature">
            <img class="gaugecwater" 
              src="../../assets/img/meter/argo2500/curve-water.png" /></div>
        </div>
      </div>
    </div>
  </div>
  </div>
  </div>
</div>












<div class="row" style="margin-top: 2%; margin-left: 1%; margin-right: 5%;">
    <img src="../../assets/img/ajax_trackvehicles.jpg" style="width: 100%;">
    

</div>
<i data-toggle="modal" data-target="#vehicleLastLocationModal" id="vehicleLastLocationModalopen"></i>
<i data-toggle="modal" data-target="#vehicleLocationModal" id="vehicleLocationModalopen"></i>
<!-- <a routerLink="add" class="btn btn-sm btn-success mb-2">Add User</a> -->
<div class="row">
    <div class="col-md-6">

    </div>

    <div class="col-md-6">
        <div class="row">
            <div class="col-md-6" style="text-align: center;">
                From
            </div>
            <div class="col-md-6" style="left: 5px;">
                To
            </div>
        </div>

    </div>
</div>


<div class="row" style = "margin-right: 4%;margin-left: 0;">
    <div class="col-md-6">


        <form class="form-inline">

            <i class="fas fa-search" aria-hidden="true"></i>
            <input class="form-control form-control-sm ml-3 w-75" type="text" placeholder="Search Vehicle"
                aria-label="Search" name="search" [(ngModel)]="searchText" autocomplete="off"
                style="background-color: #d9d9d9; ">
        </form>
    </div>



    <div class="col-md-6">
        <form class="form-inline" [formGroup]="form" (ngSubmit)="onSubmit()" style="float: right;">

            <input type="date" class="form-control" [ngModel]="startDate | date:'yyyy-MM-dd'" max="{{startDate}}"
                formControlName="startDate" style="padding: 0px 10px; margin-right: 15px;">
            <input type="date" class="form-control" [ngModel]="endDate | date:'yyyy-MM-dd'" min="{{endDate}}"
                formControlName="endDate" placeholder="Tosasasasas" style="padding: 0px 10px; margin-right: 10px;">
            <button class="btn btn-success" type="button" type="submit"
                style="background-color:  #3385ff; padding: 2px 5px; float: right;">GO!</button>

        </form>
    </div>
</div>
<div class="row">

</div>
<div class="tableFixHead" style="margin-top: 10px;margin-right: 5%;margin-left: 10px;" >
    <table class="table table-striped table-bordered table-hover">
        <thead class="thead-dark">
            <tr>
                <th style="vertical-align: top;">#</th>
                <th style="vertical-align: top;">Vehicle No. </th>
                <th style="vertical-align: top;">Pin No.</th>
                <th style="vertical-align: top;">Model</th>
                <th style="vertical-align: top;">Engine No.</th>
                <th style="vertical-align: top;">Engine Hours</th>
                <th style="vertical-align: top;">Last Data Recd.</th>
                <th style="vertical-align: top;"><i class="fas fa-list-alt fa-2x"></i></th>
                <th style="vertical-align: top;"> <i class="fas fa-route fa-2x"></i> <br>
                    (kms) </th>
                <th style="vertical-align: top; "><i class="fas fa-tachometer-alt fa-2x"> </i></th>
                <th style="vertical-align: top;"><i class="fas fa-map-marked-alt fa-2x"></i></th>
                <th style="vertical-align: top;">Actions</th>
            </tr>
        </thead>
        <tbody>
            <!-- <tr *ngFor="let v of variant"> -->
            <tr *ngFor="let t of trackdocs | filter:searchText | paginate : {itemsPerPage : 20, currentPage : p} let i = index"
                (click)="setClickedRow(i)" [class.active]="i == selectedRow">
                <td>{{i+1}}</td>
                <td> {{t.vehicleNumber}}</td>
                <td id="t1"> <a id="onNavigate" (click)="onNavigate(t.pinno)" style="color: inherit;">{{t.pinno}}</a></td>
                
                <td>{{t.deviceModel}}</td>
                
                <td>{{t.engineNumber}}</td>
                <td>{{ ConvertToInt(t.addedSeconds) + ConvertToInt(t.totalSeconds) | enginehours}}</td>
                <td>{{t.lastDataReceivedAt | date:'dd-MM-yyyy'}} <br>
                    {{t.lastDataReceivedAt | date:'h:mm a':'+0000'}}
                </td>
                <td> <a title="Report">
                    <i class="fas fa-list-alt fa-2x"></i>
                    </a> </td>
                <td> {{t.totalDistance | number :'1.2-2'}}</td>
                <td> 
                  <a title="Guage Meter">  <i class="fas fa-tachometer-alt fa-2x"
                    data-toggle="modal" data-target="#meter"></i>
                    </a>

                </td>
                <td>
                    <a title="Vehicle Map"> <div
                        (click)="mapDate(t.pinno)"> <i class="fas fa-map-marked-alt fa-2x"></i></div>
                        </a>
                </td>
                <td>
                    <ul class="actions">
                        <a>
                            <li class="actions-item"><i class="fa fa-share-square"></i></li>
                        </a>
                        <a>
                            <li class="actions-item"><i class="fa fa-clock-o"></i></li>
                        </a>
                        <a>
                            <li class="actions-item"><i class="fa fa-map-marker"
                                    (click)="trackVehicleLastLocation(t.pinno)"></i></li>
                        </a>
                        <a>
                            <li class="actions-item"><i class="fa fa-ellipsis-v "></i></li>
                        </a>

                    </ul>
                </td>
            </tr>
            <tr *ngIf="!track">
                <td colspan="4" class="text-center">
                    <span class="spinner-border spinner-border-lg align-center"></span>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="input-group-icon input-group-icon-right mr-3 col-md-12" style="margin-left: 50%;">
    <pagination-controls (pageChange)="p = $event"></pagination-controls>
</div>



<div class="modal fade" id="vehicleLocationModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Vehicle Path Map</h5>
                <button type="button" class="close" id="vehicleLocationModalclose" data-dismiss="modal"
                    aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- animation="BOUNCE" -->
                <agm-map [latitude]='maplat' [longitude]='maplng' [zoom]='12' [fullscreenControl]='true'
                    [mapTypeControl]='true' [streetViewControl]="true">
                    

                    <agm-marker *ngFor='let marker of coordinatedata'
                    [iconUrl]="{url: markerPath, scaledSize: {height: 25,width: 15}}" [latitude]='marker.lat'
                        [longitude]='marker.lng' [opacity]='opacity' [markerDraggable]='true' [agmFitBounds]="true">
                        <agm-info-window>
                            <strong>Date : {{marker.time | date:'dd-MM-yyyy'}}</strong>
                            <br>
                            <strong>Time : {{marker.time | date:'h:mm:ss a':'+0000'}}</strong>
                            <br>
                            <Strong>Lat : {{marker.lat}}</Strong>
                            <br>
                            <Strong>Lng : {{marker.lng}}</Strong>
                            <br>
                            <Strong>Pinno. : {{marker.pinno}}</Strong>
                            <br>
                            <Strong>Device-Model. : {{marker.deviceModel}}</Strong>
                            <br>
                            <Strong>Engine Status : {{marker.engineStatus}}</Strong>
                        </agm-info-window>
                    </agm-marker>
                    <agm-polyline [visible]="true" [strokeWeight]="2" [strokeColor]="'#57eaff'">
                        <agm-polyline-point *ngFor="let coordinate of coordinatedata; let i=index"
                            [latitude]="coordinate.lat" [longitude]="coordinate.lng">
                        </agm-polyline-point>
                    </agm-polyline>

                    <agm-marker *ngFor="let coordinate of end_marker; let i=index" animation="BOUNCE"
                    [iconUrl]="{url: endMark, scaledSize: {height: 50,width: 33}}"
                        [latitude]="coordinate.lat" [longitude]="coordinate.lng" [agmFitBounds]="true">
                        <agm-info-window>
                            <strong>Start</strong>
                            <hr>
                            <strong>Date : {{coordinate.time | date:'dd-MM-yyyy'}}</strong>
                            <br>
                            <strong>Time : {{coordinate.time | date:'h:mm:ss a':'+0000'}}</strong>
                            <br>
                            <Strong>Lat : {{coordinate.lat}}</Strong>
                            <br>
                            <Strong>Lng : {{coordinate.lng}}</Strong>
                            <br>
                            <Strong>Pinno. : {{coordinate.pinno}}</Strong>
                            <br>
                            <Strong>Device-Model. : {{coordinate.deviceModel}}</Strong>
                            <br>
                            <Strong>Engine Status : {{coordinate.engineStatus}}</Strong>
                        </agm-info-window>
                    </agm-marker>

                    <agm-marker *ngFor="let coordinate of start_marker; let i=index" animation="BOUNCE"
                    [iconUrl]="{url: startMarker, scaledSize: {height: 50,width: 34}}"
                        [latitude]="coordinate.lat" [longitude]="coordinate.lng" [agmFitBounds]="true">
                        <agm-info-window>
                            <strong>End</strong>
                            <hr>
                            <strong>Date : {{coordinate.time | date:'dd-MM-yyyy'}}</strong>
                            <br>
                            <strong>Time : {{coordinate.time | date:'h:mm:ss a':'+0000'}}</strong>
                            <br>
                            <Strong>Lat : {{coordinate.lat}}</Strong>
                            <br>
                            <Strong>Lng : {{coordinate.lng}}</Strong>
                            <br>
                            <Strong>Pinno. : {{coordinate.pinno}}</Strong>
                            <br>
                            <Strong>Device-Model. : {{coordinate.deviceModel}}</Strong>
                            <br>
                            <Strong>Engine Status : {{coordinate.engineStatus}}</Strong>
                        </agm-info-window>
                    </agm-marker>
                </agm-map>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Last Location -->
<div class="modal fade" id="vehicleLastLocationModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Vehicle Last Location</h5>
                <button type="button" class="close" id="vehicleLastLocationModalClose" data-dismiss="modal"
                    aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <agm-map [latitude]='lastLocationlat' [longitude]='lastLocationlng' [zoom]='8'
                    [fullscreenControl]='true' [mapTypeControl]='true' [streetViewControl]="false">
                    <agm-marker [latitude]='lastLocationlat' [longitude]='lastLocationlng' [opacity]='opacity'
                        [markerDraggable]='false' [agmFitBounds]="true">
                        <agm-info-window>
                            <strong>lat : {{lastLocationlat}}</strong>
                            <br>
                            <strong>lng : {{lastLocationlng}}</strong>
                        </agm-info-window>
                    </agm-marker>
                </agm-map>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>
